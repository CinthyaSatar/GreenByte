{% extends "layout.html" %} {% block content %}
<div class="container-fluid">
  <div class="row">
    <!-- Weekly Calendar Section (Left) -->
    <div class="col-xl-9 col-lg-8">
      <div class="card shadow mb-4">
        <div
          class="card-header py-3 d-flex flex-row align-items-center justify-content-between"
          style="border-bottom: 1px solid rgba(28, 200, 138, 0.2)"
        >
          <div class="d-flex align-items-center">
            <h6 class="m-0 font-weight-bold" style="color: #1cc88a">
              Weekly Schedule
            </h6>
            <div class="d-flex align-items-center" style="margin-left: 3rem">
              <a
                href="{{ url_for('main.calendar', date_str=prev_week) }}"
                class="btn btn-sm mr-2"
                style="
                  border: 1px solid rgba(28, 200, 138, 0.2);
                  color: #1cc88a;
                "
              >
                <i class="fas fa-chevron-left"></i>
              </a>
              <h6 class="m-0">{{ date_range }}</h6>
              <a
                href="{{ url_for('main.calendar', date_str=next_week) }}"
                class="btn btn-sm ml-2"
                style="
                  border: 1px solid rgba(28, 200, 138, 0.2);
                  color: #1cc88a;
                "
              >
                <i class="fas fa-chevron-right"></i>
              </a>
            </div>
          </div>
          <a
            href="#"
            class="btn btn-sm"
            style="
              background: rgba(28, 200, 138, 0.1);
              color: #1cc88a;
              border: 1px solid rgba(28, 200, 138, 0.2);
            "
            data-bs-toggle="modal"
            data-bs-target="#addEventModal"
          >
            <i class="fas fa-plus fa-sm"></i>
          </a>
        </div>
        <div class="card-body p-0">
          <div class="weekly-board">
            <div class="board-columns">
              {% for day in days %}
              <div class="board-column">
                <div class="column-header">
                  <div class="day-name">{{ day.name }}</div>
                  <div class="day-date">{{ day.date }}</div>
                </div>
                <div class="column-content">
                  <!-- Debug: {{ day.name }} has {{ day.events|length }} events -->
                  {% for event in day.events %}
                  <div class="event-card" data-event-id="{{ event.id }}" onclick="openViewEventModal({{ event.id }})" style="background-color: #f8f9fc; border-left: 3px solid {% if event.type == 'work' %}#1cc88a{% elif event.type == 'community' %}#4e73df{% elif event.type == 'school' %}#f6c23e{% elif event.type == 'personal' %}#e74a3b{% else %}#1cc88a{% endif %}; margin-bottom: 8px; padding: 8px; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <div class="event-title" style="font-weight: bold;">{{ event.title }}</div>
                    <div class="event-time" style="font-size: 0.8rem; color: #666;">
                      <i class="fas fa-clock fa-sm"></i> {{ event.time }}
                    </div>
                  </div>
                  {% else %}
                  <!-- No events for {{ day.name }} -->
                  {% endfor %}
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar (Right) -->
    <div class="col-xl-3 col-lg-4">
      <!-- Mini Monthly Calendar -->
      <div class="card shadow mb-4">
        <div
          class="card-header py-3"
          style="border-bottom: 1px solid rgba(28, 200, 138, 0.2)"
        >
          <h6 class="m-0 font-weight-bold" style="color: #1cc88a">
            March 2024
          </h6>
        </div>
        <div class="card-body p-2">
          <div class="mini-calendar">
            <div class="row text-center mb-2">
              {% for day in ['S', 'M', 'T', 'W', 'T', 'F', 'S'] %}
              <div class="col px-1">
                <small style="color: #858796">{{ day }}</small>
              </div>
              {% endfor %}
            </div>
            {% for week in range(5) %}
            <div class="row text-center mb-2">
              {% for day in range(7) %}
              <div class="col px-1">
                <div class="mini-day-wrapper">
                  <div
                    class="mini-day p-1 {% if loop.index == 3 and week == 1 %}bg-success-light{% endif %}"
                    style="border-radius: 4px; cursor: pointer"
                  >
                    <small>{{ loop.index + (week * 7) }}</small>
                  </div>
                  <!-- Add event indicator dot - we'll control visibility with has-event class -->
                  <div
                    class="event-indicator {% if (loop.index + (week * 7)) in [11, 13, 15] %}has-event{% endif %}"
                  ></div>
                </div>
              </div>
              {% endfor %}
            </div>
            {% endfor %}
          </div>
        </div>
      </div>

      <!-- Upcoming Events -->
      <div class="card shadow mb-4">
        <div
          class="card-header py-3"
          style="border-bottom: 1px solid rgba(28, 200, 138, 0.2)"
        >
          <h6 class="m-0 font-weight-bold" style="color: #1cc88a">
            Upcoming Events
          </h6>
        </div>
        <div class="card-body">
          {% for event in upcoming_events %}
          <div
            class="upcoming-event d-flex align-items-center p-2 {% if not loop.last %}mb-3{% endif %}"
            style="
              border-left: 3px solid {% if event.calendar_type == 'work' %}#1cc88a{% elif event.calendar_type == 'community' %}#4e73df{% elif event.calendar_type == 'school' %}#f6c23e{% elif event.calendar_type == 'personal' %}#e74a3b{% else %}#1cc88a{% endif %};
              background: rgba(28, 200, 138, 0.05);
            "
            data-event-id="{{ event.id }}"
            onclick="openViewEventModal({{ event.id }})"
          >
            <div class="event-date text-center me-3" style="min-width: 50px">
              <small class="text-gray-500 d-block">{{ event.start_datetime.strftime('%b').upper() }}</small>
              <div class="h5 mb-0" style="color: {% if event.calendar_type == 'work' %}#1cc88a{% elif event.calendar_type == 'community' %}#4e73df{% elif event.calendar_type == 'school' %}#f6c23e{% elif event.calendar_type == 'personal' %}#e74a3b{% else %}#1cc88a{% endif %};">{{ event.start_datetime.strftime('%d') }}</div>
            </div>
            <div class="event-details">
              <h6 class="mb-0">{{ event.title }}</h6>
              <small class="text-gray-600">
                <i class="fas fa-clock fa-sm me-1"></i>{{ event.start_datetime.strftime('%I:%M %p') if not event.all_day else 'All Day' }}
              </small>
            </div>
          </div>
          {% else %}
          <div class="text-center py-3">
            <p class="text-muted">No upcoming events</p>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add Event Modal -->
<div
  class="modal fade"
  id="addEventModal"
  tabindex="-1"
  aria-labelledby="addEventModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div
        class="modal-header"
        style="border-bottom: 1px solid rgba(28, 200, 138, 0.2)"
      >
        <h5 class="modal-title" id="addEventModalLabel" style="color: #1cc88a">
          New Event
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form id="eventForm" action="{{ url_for('main.add_event') }}" method="POST">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <!-- Title and Location Section -->
          <div class="form-group mb-3">
            <input
              type="text"
              class="form-control form-control-lg"
              id="eventTitle"
              name="eventTitle"
              placeholder="Add title"
              required
            />
          </div>
          <div class="form-group mb-3">
            <div class="input-group">
              <span class="input-group-text"
                ><i class="fas fa-map-marker-alt"></i
              ></span>
              <input
                type="text"
                class="form-control"
                id="location"
                name="location"
                placeholder="Add location or video call"
              />
            </div>
          </div>

          <!-- Date and Time Section -->
          <div class="form-group mb-3">
            <div class="d-flex align-items-center mb-2">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="allDayEvent"
                  name="allDayEvent"
                />
                <label class="form-check-label" for="allDayEvent"
                  >All-day</label
                >
              </div>
            </div>

            <div class="row mb-2">
              <label class="col-2">Starts</label>
              <div class="col-5">
                <input
                  type="date"
                  class="form-control"
                  id="startDate"
                  name="startDate"
                  required
                />
              </div>
              <div class="col-5" id="startTimeContainer">
                <input
                  type="time"
                  class="form-control"
                  id="startTime"
                  name="startTime"
                  required
                />
              </div>
            </div>

            <div class="row">
              <label class="col-2">Ends</label>
              <div class="col-5">
                <input type="date" class="form-control" id="endDate" name="endDate" required />
              </div>
              <div class="col-5" id="endTimeContainer">
                <input type="time" class="form-control" id="endTime" name="endTime" required />
              </div>
            </div>
          </div>

          <!-- Repeat Section -->
          <div class="form-group mb-3">
            <div class="row">
              <label class="col-2">Repeat</label>
              <div class="col-10">
                <select class="form-select" id="repeatOption" name="repeatOption">
                  <option value="none">Never</option>
                  <option value="daily">Every Day</option>
                  <option value="weekly">Every Week</option>
                  <option value="biweekly">Every 2 Weeks</option>
                  <option value="monthly">Every Month</option>
                  <option value="yearly">Every Year</option>
                </select>
              </div>
            </div>
            <div class="row mt-2">
              <label class="col-2">End Repeat</label>
              <div class="col-10">
                <select class="form-select" id="endRepeat" name="endRepeat">
                  <option value="">Never</option>
                  <option value="on">On Date</option>
                </select>
                <input type="date" class="form-control mt-2" id="endRepeatDate" name="endRepeatDate" style="display: none;" />
              </div>
            </div>
          </div>

          <!-- Calendar Selection -->
          <div class="form-group mb-3">
            <div class="row">
              <label class="col-2">Calendar</label>
              <div class="col-10">
                <select class="form-select" id="calendar" name="calendar">
                  <option value="work" style="color: #1cc88a">Work</option>
                  <option value="community" style="color: #4e73df">
                    Community
                  </option>
                  <option value="school" style="color: #f6c23e">School</option>
                  <option value="personal" style="color: #e74a3b">
                    Personal
                  </option>
                </select>
              </div>
            </div>
          </div>

          <!-- Invitees Section -->
          <div class="form-group mb-3">
            <div class="input-group">
              <span class="input-group-text"><i class="fas fa-users"></i></span>
              <input
                type="text"
                class="form-control"
                id="invitees"
                name="invitees"
                placeholder="Add invitees (comma separated emails)"
              />
            </div>
          </div>

          <!-- Garden and Plant Selection -->
          <div class="form-group mb-3">
            <div class="row">
              <label class="col-2">Garden</label>
              <div class="col-10">
                <select class="form-select" id="garden_id" name="garden_id">
                  <option value="">None</option>
                  {% for garden in gardens %}
                  <option value="{{ garden.id }}">{{ garden.name }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
          </div>

          <div class="form-group mb-3">
            <div class="row">
              <label class="col-2">Plant</label>
              <div class="col-10">
                <select class="form-select" id="plant_id" name="plant_id">
                  <option value="">None</option>
                  {% for plant in plants %}
                  <option value="{{ plant.id }}">{{ plant.plant_detail.name }} {% if plant.variety %}({{ plant.variety.name }}){% endif %}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
          </div>

          <!-- Alert Section -->
          <div class="form-group mb-3">
            <div class="row">
              <label class="col-2">Alert</label>
              <div class="col-10">
                <select class="form-select" id="alert" name="alert">
                  <option value="0">At time of event</option>
                  <option value="5">5 minutes before</option>
                  <option value="10">10 minutes before</option>
                  <option value="15">15 minutes before</option>
                  <option value="30">30 minutes before</option>
                  <option value="60">1 hour before</option>
                  <option value="1440">1 day before</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Private Toggle -->
          <div class="form-group mb-3">
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                id="privateEvent"
                name="privateEvent"
              />
              <label class="form-check-label" for="privateEvent">Private</label>
            </div>
          </div>

          <!-- URL -->
          <div class="form-group mb-3">
            <div class="input-group">
              <span class="input-group-text"><i class="fas fa-link"></i></span>
              <input
                type="url"
                class="form-control"
                id="eventUrl"
                name="eventUrl"
                placeholder="Add URL"
              />
            </div>
          </div>

          <!-- Notes -->
          <div class="form-group mb-3">
            <textarea
              class="form-control"
              id="notes"
              name="notes"
              rows="3"
              placeholder="Add notes"
            ></textarea>
          </div>
        </form>
      </div>
      <div
        class="modal-footer"
        style="border-top: 1px solid rgba(28, 200, 138, 0.2)"
      >
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Cancel
        </button>
        <button type="button" class="btn btn-success" onclick="saveEvent()">
          Add Event
        </button>
      </div>
    </div>
  </div>
</div>

<!-- View/Edit Event Modal -->
<div class="modal fade" id="viewEventModal" tabindex="-1" aria-labelledby="viewEventModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header" style="border-bottom: 1px solid rgba(28, 200, 138, 0.2)">
        <h5 class="modal-title" id="viewEventModalLabel" style="color: #1cc88a">Event Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="eventDetails">
          <!-- Event details will be loaded here -->
          <div class="text-center py-4">
            <div class="spinner-border text-success" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer" style="border-top: 1px solid rgba(28, 200, 138, 0.2)">
        <button type="button" class="btn btn-danger" onclick="confirmDeleteEvent()">Delete</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <a id="editEventLink" href="#" class="btn btn-success">Edit</a>
      </div>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header" style="border-bottom: 1px solid rgba(220, 53, 69, 0.2)">
        <h5 class="modal-title" id="deleteConfirmModalLabel" style="color: #dc3545">Confirm Delete</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this event?</p>
      </div>
      <div class="modal-footer" style="border-top: 1px solid rgba(220, 53, 69, 0.2)">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" onclick="deleteEvent()">Delete</button>
      </div>
    </div>
  </div>
</div>

<!-- Add this JavaScript -->
<script>
  let currentEventId = null;

  document.addEventListener("DOMContentLoaded", function () {
    // Set default dates to today
    const today = new Date();
    const todayStr = today.toISOString().split("T")[0];
    document.getElementById("startDate").value = todayStr;
    document.getElementById("endDate").value = todayStr;

    // Handle all-day event toggle
    const allDayCheckbox = document.getElementById("allDayEvent");
    const startTimeContainer = document.getElementById("startTimeContainer");
    const endTimeContainer = document.getElementById("endTimeContainer");

    allDayCheckbox.addEventListener("change", function () {
      startTimeContainer.style.display = this.checked ? "none" : "block";
      endTimeContainer.style.display = this.checked ? "none" : "block";
    });

    // Handle repeat option changes
    const repeatOption = document.getElementById("repeatOption");
    const endRepeatContainer =
      document.getElementById("endRepeat").parentElement.parentElement;
    const endRepeatSelect = document.getElementById("endRepeat");
    const endRepeatDate = document.getElementById("endRepeatDate");

    repeatOption.addEventListener("change", function () {
      endRepeatContainer.style.display =
        this.value === "none" ? "none" : "flex";
    });

    endRepeatSelect.addEventListener("change", function() {
      endRepeatDate.style.display = this.value === "on" ? "block" : "none";
    });

    // Initialize event cards to be clickable
    document.querySelectorAll('.event-card').forEach(card => {
      card.addEventListener('click', function() {
        const eventId = this.getAttribute('data-event-id');
        if (eventId) {
          openViewEventModal(eventId);
        }
      });
    });

    // Fix for modal backdrop issue
    const fixBackdropIssue = () => {
      // Remove any lingering backdrops
      const backdrops = document.querySelectorAll('.modal-backdrop');
      backdrops.forEach(backdrop => {
        backdrop.remove();
      });
      // Remove modal-open class from body
      document.body.classList.remove('modal-open');
      document.body.style.overflow = '';
      document.body.style.paddingRight = '';
    };

    // Add event listeners to all modal close buttons
    document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(button => {
      button.addEventListener('click', fixBackdropIssue);
    });

    // Handle ESC key to close modals
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        fixBackdropIssue();
      }
    });

    // Initialize modals with proper handling
    const viewEventModal = document.getElementById('viewEventModal');
    if (viewEventModal) {
      viewEventModal.addEventListener('hidden.bs.modal', fixBackdropIssue);
    }

    const deleteConfirmModal = document.getElementById('deleteConfirmModal');
    if (deleteConfirmModal) {
      deleteConfirmModal.addEventListener('hidden.bs.modal', fixBackdropIssue);
    }

    const addEventModal = document.getElementById('addEventModal');
    if (addEventModal) {
      addEventModal.addEventListener('hidden.bs.modal', fixBackdropIssue);
    }
  });

  function saveEvent() {
    // Get form element
    const form = document.getElementById("eventForm");

    // Submit the form
    form.submit();
  }

  function openViewEventModal(eventId) {
    currentEventId = eventId;

    // Show loading spinner
    document.getElementById('eventDetails').innerHTML = `
      <div class="text-center py-4">
        <div class="spinner-border text-success" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    `;

    // Update the edit link
    document.getElementById('editEventLink').href = `/calendar/events/${eventId}/edit`;

    // Show the modal
    const viewEventModal = new bootstrap.Modal(document.getElementById('viewEventModal'));
    viewEventModal.show();

    // Fetch event details
    fetch(`/calendar/events/${eventId}`)
      .then(response => {
        if (!response.ok) {
          throw new Error('Failed to fetch event details');
        }
        return response.json();
      })
      .then(event => {
        // Format dates
        const startDate = new Date(event.start_datetime);
        const endDate = event.end_datetime ? new Date(event.end_datetime) : null;

        // Format time display
        const timeDisplay = event.all_day ? 'All Day' :
          `${startDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} -
           ${endDate ? endDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) : ''}`;

        // Get calendar color
        let calendarColor = '#1cc88a'; // Default green
        if (event.calendar_type === 'community') calendarColor = '#4e73df';
        if (event.calendar_type === 'school') calendarColor = '#f6c23e';
        if (event.calendar_type === 'personal') calendarColor = '#e74a3b';

        // Build HTML for event details
        let html = `
          <div class="event-header mb-3 pb-2" style="border-bottom: 1px solid rgba(28, 200, 138, 0.2)">
            <h4>${event.title}</h4>
            <div class="d-flex align-items-center">
              <span class="badge me-2" style="background-color: ${calendarColor}">${event.calendar_type}</span>
              <i class="fas fa-clock fa-sm me-1"></i> ${timeDisplay}
            </div>
          </div>
        `;

        if (event.location) {
          html += `
            <div class="mb-3">
              <i class="fas fa-map-marker-alt me-2"></i> ${event.location}
            </div>
          `;
        }

        if (event.description) {
          html += `
            <div class="mb-3">
              <h6>Description</h6>
              <p>${event.description}</p>
            </div>
          `;
        }

        if (event.repeat_type) {
          html += `
            <div class="mb-3">
              <i class="fas fa-sync-alt me-2"></i> Repeats ${event.repeat_type}
              ${event.repeat_end_date ? ` until ${new Date(event.repeat_end_date).toLocaleDateString()}` : ''}
            </div>
          `;
        }

        if (event.garden_id || event.plant_id) {
          html += `<div class="mb-3">`;

          if (event.garden_id) {
            html += `<div><i class="fas fa-leaf me-2"></i> Garden: ${event.garden_id}</div>`;
          }

          if (event.plant_id) {
            html += `<div><i class="fas fa-seedling me-2"></i> Plant: ${event.plant_id}</div>`;
          }

          html += `</div>`;
        }

        if (event.url) {
          html += `
            <div class="mb-3">
              <i class="fas fa-link me-2"></i> <a href="${event.url}" target="_blank">${event.url}</a>
            </div>
          `;
        }

        // Update the modal content
        document.getElementById('eventDetails').innerHTML = html;
      })
      .catch(error => {
        console.error('Error fetching event details:', error);
        document.getElementById('eventDetails').innerHTML = `
          <div class="alert alert-danger">
            Failed to load event details. Please try again.
          </div>
        `;
      });
  }

  function confirmDeleteEvent() {
    // Hide the view modal and show the delete confirmation modal
    bootstrap.Modal.getInstance(document.getElementById('viewEventModal')).hide();
    const deleteConfirmModal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));
    deleteConfirmModal.show();
  }

  function deleteEvent() {
    if (!currentEventId) return;

    // Get CSRF token from meta tag
    const csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');

    // Send delete request
    fetch(`/calendar/events/${currentEventId}`, {
      method: 'DELETE',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': csrfToken
      }
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('Failed to delete event');
      }
      return response.json();
    })
    .then(data => {
      // Hide the modal
      bootstrap.Modal.getInstance(document.getElementById('deleteConfirmModal')).hide();

      // Show success message and reload the page
      alert('Event deleted successfully!');
      window.location.reload();
    })
    .catch(error => {
      console.error('Error deleting event:', error);
      alert('Failed to delete event. Please try again.');
    });
  }

  function editEvent() {
    // Redirect to edit page or implement in-place editing
    if (currentEventId) {
      window.location.href = `/calendar/events/${currentEventId}/edit`;
    }
  }
</script>

<!-- Add these styles -->
<style>
  .modal-dialog {
    max-width: 500px;
  }

  .form-group label {
    color: #5a5c69;
    font-weight: 500;
  }

  .input-group-text {
    background-color: transparent;
    border-right: none;
  }

  .input-group .form-control {
    border-left: none;
  }

  .form-control:focus {
    border-color: #1cc88a;
    box-shadow: 0 0 0 0.2rem rgba(28, 200, 138, 0.25);
  }

  .form-select:focus {
    border-color: #1cc88a;
    box-shadow: 0 0 0 0.2rem rgba(28, 200, 138, 0.25);
  }
</style>

<!-- Custom styles -->
<style>
  .weekly-board {
    height: calc(100vh - 200px);
    overflow: hidden; /* Remove horizontal scroll */
  }

  .board-columns {
    display: flex;
    min-height: 100%;
    width: 100%; /* Ensure full width */
  }

  .board-column {
    flex: 1;
    min-width: 0; /* Remove min-width to allow shrinking */
    border-right: 1px solid rgba(28, 200, 138, 0.1);
  }

  .board-column:last-child {
    border-right: none;
  }

  .column-header {
    padding: 0.5rem; /* Reduced padding */
    background: rgba(28, 200, 138, 0.05);
    border-bottom: 1px solid rgba(28, 200, 138, 0.1);
    text-align: center;
  }

  .day-name {
    color: #5a5c69;
    font-weight: 600;
    font-size: 0.85rem; /* Slightly smaller font */
  }

  .day-date {
    color: #858796;
    font-size: 0.75rem;
  }

  .column-content {
    padding: 0.5rem; /* Reduced padding */
    min-height: 100%;
    overflow-y: auto; /* Allow vertical scrolling within columns */
  }

  .event-card {
    background: white;
    border-radius: 4px; /* Slightly smaller radius */
    padding: 0.5rem; /* Reduced padding */
    margin-bottom: 0.5rem;
    border-left: 3px solid #1cc88a;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    cursor: pointer;
    transition: all 0.2s ease;
    word-break: break-word; /* Prevent text overflow */
  }

  .event-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .event-title {
    color: #5a5c69;
    font-weight: 500;
    margin-bottom: 0.25rem;
    font-size: 0.85rem; /* Slightly smaller font */
  }

  .event-time {
    color: #858796;
    font-size: 0.7rem; /* Slightly smaller font */
  }

  .event-time i {
    margin-right: 0.25rem;
  }

  .bg-success-light {
    background-color: rgba(28, 200, 138, 0.1);
  }

  .mini-day:hover {
    background-color: rgba(28, 200, 138, 0.1);
  }

  .hour-slot:hover {
    background-color: rgba(28, 200, 138, 0.05);
  }

  .upcoming-event {
    transition: all 0.3s ease;
    border-radius: 4px;
  }

  .upcoming-event:hover {
    transform: translateX(5px);
  }

  .event-card {
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .event-card:hover {
    transform: scale(1.02);
  }

  /* Make calendar more compact on smaller screens */
  @media (max-width: 1200px) {
    .day-name {
      font-size: 0.8rem;
    }

    .event-title {
      font-size: 0.8rem;
    }

    .column-header {
      padding: 0.4rem;
    }

    .column-content {
      padding: 0.4rem;
    }
  }

  .mini-day-wrapper {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .event-indicator {
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background-color: #1cc88a;
    margin-top: 2px;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .event-indicator.has-event {
    opacity: 1;
  }

  /* Optional: Add different colors for different calendar types */
  .event-indicator.work {
    background-color: #1cc88a;
  }

  .event-indicator.community {
    background-color: #4e73df;
  }

  .event-indicator.school {
    background-color: #f6c23e;
  }

  .event-indicator.personal {
    background-color: #e74a3b;
  }

  /* If you want to show multiple dots for multiple events */
  .event-indicator-multiple {
    display: flex;
    gap: 2px;
  }

  .event-indicator-multiple .dot {
    width: 4px;
    height: 4px;
    border-radius: 50%;
  }
</style>
{% endblock content %}
